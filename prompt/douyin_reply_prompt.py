import os
import random

from tool_static import 得到一个不重复的文件路径, 路径到链接


def random_select_two_dimensions():
    """
    从预设的维度列表中随机选择两个不重复的元素

    Returns:
        tuple: 包含两个随机选中的维度名称的元组
    """
    # 定义所有的数据维度列表
    dimensions = [
        "投稿数",
        "投稿数同比",
        "播放量",
        "播放量同比",
        "点赞量",
        "点赞量同比",
        "完播率",
        "完播率同比",
        "互动指数",
        "作品搜索量",
        "作品搜索量同比",
        "粉丝净增",
        "播放量超越比例"
    ]

    # 随机选择2个不重复的元素
    # sample函数会确保选中的元素不重复，且数量准确
    selected = random.sample(dimensions, 2)

    # 返回元组形式（比列表更适合固定数量的返回值）
    return '+'.join(selected)


def get_random_comment():
    l = ['[用户名称]分享的[具体主题]也太戳了😭！[钩子植入锚点]', '真的太有同感了～ [用户名称]！聊到[具体主题]这类内容，[钩子植入锚点]', '刷到[用户名称]的[具体主题]视频就停不下来✨！[钩子植入锚点]',
         '说的太对了[用户名称]！[具体主题]相关内容我之前也遇到，[钩子植入锚点]', '[具体主题]里的这种烟火气谁不爱啊～ [用户名称]！[钩子植入锚点]',
         '[用户名称]！你这[具体主题]视频说到我心坎里了😘～ [钩子植入锚点]', '太治愈了～ [用户名称]拍的[具体主题]日常！[钩子植入锚点]',
         '谁懂啊～ [用户名称]！做[具体主题]内容选对方向太重要，[钩子植入锚点]',
         '看完[用户名称]的[具体主题]分享，突然有动力了💪！[钩子植入锚点]', '[具体主题]带来的这种心情我太懂了～ [用户名称]！[钩子植入锚点]',
         '[用户名称]！不愧是你👍！关于[具体主题]的内容，[钩子植入锚点]',
         '越看越有感触～ [用户名称]！[具体主题]相关创作里，[钩子植入锚点]', '救命！[用户名称]这[具体主题]视频也太真实了😝～ [钩子植入锚点]',
         '太认同了～ [用户名称]！聊到[具体主题]我可太有话说了，[钩子植入锚点]', '[用户名称]的[具体主题]视频总能说到点子上✨！[钩子植入锚点]',
         '[具体主题]相关的这种经历我也有！[用户名称]～ [钩子植入锚点]',
         '刷到[用户名称]的[具体主题]内容太幸运了🌟！[钩子植入锚点]', '[用户名称]！这[具体主题]内容值得反复看～ [钩子植入锚点]', '真的哭死～ [用户名称]说的[具体主题]情况就是我！[钩子植入锚点]',
         '太有道理了～ [用户名称]！关于[具体主题]的这类分享，[钩子植入锚点]', '[用户名称]！其实做[具体主题]这类内容，我踩过不少坑😮\u200d💨～ [钩子植入锚点]',
         '分享个小感受～ [用户名称]！[具体主题]相关创作里，[钩子植入锚点]', '[用户名称]的[具体主题]思路太顶了👏！[钩子植入锚点]', '其实我发现～ [用户名称]！发了十几条[具体主题]作品，[钩子植入锚点]',
         '[用户名称]！过来人说句实话～ 做[具体主题]这个主题的内容，[钩子植入锚点]', '给[用户名称]点个赞👍！围绕[具体主题]这个方向创作，[钩子植入锚点]',
         '[用户名称]！我之前做[具体主题]这类内容也迷茫过～ [钩子植入锚点]', '亲测有效～ [用户名称]！拍[具体主题]相关视频，[钩子植入锚点]', '[用户名称]的[具体主题]视频点醒我了💡！[钩子植入锚点]',
         '说个小体会～ [用户名称]！做[具体主题]内容，[钩子植入锚点]', '[用户名称]！别灰心～ 关于[具体主题]的创作，[钩子植入锚点]', '我总结的小经验～ [用户名称]！做[具体主题]内容，[钩子植入锚点]',
         '[用户名称]！这波[具体主题]分享太值了～ [钩子植入锚点]', '踩过坑才知道～ [用户名称]！拍[具体主题]这类视频，[钩子植入锚点]', '[用户名称]！其实[具体主题]内容的互动真的重要～ [钩子植入锚点]',
         '真心话～ [用户名称]！创作[具体主题]相关内容，[钩子植入锚点]', '[用户名称]对[具体主题]的坚持太打动人了✨！[钩子植入锚点]', '分享下我的小历程～ [用户名称]！做[具体主题]内容，[钩子植入锚点]',
         '[用户名称]！选对[具体主题]的创作方向太重要了～ [钩子植入锚点]', '我也算摸出点门道了～ [用户名称]！围绕[具体主题]创作，[钩子植入锚点]',
         '[用户名称]！看你的[具体主题]视频突然感慨😌～ [钩子植入锚点]', '成长就是慢慢摸索的过程～ [用户名称]！做[具体主题]内容，[钩子植入锚点]',
         '[用户名称]的[具体主题]视频让我想起自己✨！[钩子植入锚点]',
         '真的不容易啊～ [用户名称]！发了十几条[具体主题]作品，[钩子植入锚点]', '[用户名称]！谁不是从新手过来的😭～ 做[具体主题]内容，[钩子植入锚点]',
         '越做越有感觉了～ [用户名称]！关于[具体主题]的创作，[钩子植入锚点]', '[用户名称]对[具体主题]的坚持我太懂了💪！[钩子植入锚点]',
         '回头看真的感慨～ [用户名称]！创作[具体主题]内容，[钩子植入锚点]',
         '[用户名称]！这一路做[具体主题]的艰辛真的只有自己懂～ [钩子植入锚点]', '成长的路上都是风景～ [用户名称]！拍[具体主题]视频，[钩子植入锚点]',
         '[用户名称]！太能共情了～ 关于[具体主题]的内容，[钩子植入锚点]', '从迷茫到找到方向～ [用户名称]！做[具体主题]创作，[钩子植入锚点]', '[用户名称]的[具体主题]视频太戳心了😘～ [钩子植入锚点]',
         '慢慢变好就是最好的～ [用户名称]！围绕[具体主题]创作，[钩子植入锚点]', '[用户名称]！谁没经历过[具体主题]创作的低谷期～ [钩子植入锚点]',
         '真的太有感触了～ [用户名称]！更新[具体主题]相关作品，[钩子植入锚点]', '[用户名称]！这就是[具体主题]创作的真实日常～ [钩子植入锚点]',
         '熬过来就会发现～ [用户名称]！做[具体主题]内容，[钩子植入锚点]',
         '[用户名称]的[具体主题]分享太真实了🌟！[钩子植入锚点]', '创作的路上不孤单～ [用户名称]！做[具体主题]相关内容，[钩子植入锚点]', '[用户名称]！唠唠[具体主题]～ [钩子植入锚点]',
         '哈哈哈[用户名称]！你聊的[具体主题]太逗了～ [钩子植入锚点]', '[用户名称]！随便聊聊[具体主题]～ [钩子植入锚点]', '唠两句～ [用户名称]！关于[具体主题]的内容，[钩子植入锚点]',
         '[用户名称]！[具体主题]这话题我能聊半天😝～ [钩子植入锚点]', '随便唠唠～ [用户名称]！拍[具体主题]相关视频，[钩子植入锚点]',
         '[用户名称]！太对了太对了～ 关于[具体主题]的创作，[钩子植入锚点]',
         '唠嗑时间～ [用户名称]！做[具体主题]内容，[钩子植入锚点]', '[用户名称]！懂的都懂～ 聊到[具体主题]，[钩子植入锚点]', '哈哈哈[用户名称]！你说的[具体主题]太说到点子上了～ [钩子植入锚点]',
         '[用户名称]！闲聊两句[具体主题]～ [钩子植入锚点]', '唠唠我的[具体主题]创作日常～ [用户名称]！[钩子植入锚点]', '[用户名称]！这才是[具体主题]的真实状态～ [钩子植入锚点]',
         '随便聊聊[具体主题]创作～ [用户名称]！[钩子植入锚点]', '[用户名称]！太有共鸣了～ 关于[具体主题]的内容，[钩子植入锚点]', '唠嗑啦～ [用户名称]！分享[具体主题]相关内容，[钩子植入锚点]',
         '[用户名称]！你对[具体主题]的看法我举双手赞成🙌～[钩子植入锚点]', '闲聊一下～ [用户名称]！做[具体主题]内容，[钩子植入锚点]',
         '[用户名称]！主打一个真实分享[具体主题]～ 我播放量一万八九，点赞六百多，不卷数据卷内容质量～', '唠唠心里话～ [用户名称]！关于[具体主题]的创作，[钩子植入锚点]',
         '[用户名称]！加油呀💪！做[具体主题]内容，[钩子植入锚点]', '给[用户名称]打call📣！分享[具体主题]的你超棒～ [钩子植入锚点]', '[用户名称]！别放弃～ 关于[具体主题]的创作，[钩子植入锚点]',
         '为[用户名称]点赞👍！专注[具体主题]的你一定会被看到～ [钩子植入锚点]', '[用户名称]！继续冲～ 创作[具体主题]相关内容，[钩子植入锚点]',
         '太佩服[用户名称]了✨！坚持分享[具体主题]，[钩子植入锚点]',
         '[用户名称]！你超棒的～ 你的[具体主题]内容很打动人，[钩子植入锚点]', '鼓励一下[用户名称]💖！关于[具体主题]的分享，[钩子植入锚点]', '[用户名称]！坚持下去～ 做[具体主题]内容，[钩子植入锚点]',
         '为[用户名称]鼓掌👏！分享[具体主题]的你超用心～ [钩子植入锚点]', '[用户名称]！慢慢来～ 创作[具体主题]相关作品，[钩子植入锚点]',
         '[用户名称]的[具体主题]视频超治愈～ 继续加油😘！[钩子植入锚点]',
         '给[用户名称]加鸡腿🍗！你的[具体主题]内容太戳人了～ [钩子植入锚点]', '[用户名称]！别焦虑～ 做[具体主题]创作，[钩子植入锚点]', '超喜欢[用户名称]的[具体主题]内容✨！[钩子植入锚点]',
         '[用户名称]！你超有天赋的～ 关于[具体主题]的创作，[钩子植入锚点]', '鼓励[用户名称]一波💪！你的[具体主题]内容会被更多人搜到～ [钩子植入锚点]',
         '[用户名称]！未来可期～ 分享[具体主题]的每一条作品都是成长～ [钩子植入锚点]', '为[用户名称]打抱不平😜！这么好的[具体主题]内容必须被更多人看到～ [钩子植入锚点]',
         '[用户名称]！相信自己～ 专注[具体主题]的创作终有回报～ [钩子植入锚点]']
    return random.choice(l)


def gen_prompt_html(account_json_data, video_user_name, video_content):
    hook_dimensions = random_select_two_dimensions()
    comment_template = get_random_comment()
    current_dir = os.path.dirname(os.path.abspath(__file__))

    with open(f'{current_dir}/douyin_reply_template.html', encoding='utf8') as f:
        content = f.read()
    content = content.replace('{{ account_data }}', account_json_data)
    content = content.replace('{{ name }}', video_user_name)
    content = content.replace('{{ content }}', video_content)
    content = content.replace('{{ hook_dimensions }}', hook_dimensions)
    content = content.replace('{{ comment_template }}', comment_template)
    return content


def gen_prompt_url(account_json_data, video_user_name, video_content):
    html = gen_prompt_html(account_json_data, video_user_name, video_content)
    fpath = 得到一个不重复的文件路径(fpath='prompt.html', sub_dir='tmp')
    with open(fpath, 'w', encoding='utf8') as f:
        f.write(html)
    return 路径到链接(fpath)


if __name__ == '__main__':
    account_json_data = '''
        {
            "截图识别时间": "2026-01-14T00:01:00Z",
            "数据更新说明": "部分数据次日更新",
            "数据时间范围": "近7日",
            "核心数据模块": {
            "投稿数": 4,
            "投稿数同比": "+100%",
            "播放量": 1864,
            "播放量同比": "841%",
            "点赞量": 344,
            "点赞量同比": "11367%",
            "完播率": "34.46%",
            "完播率同比": "2795%",
            "互动指数": "38.57%",
            "作品搜索量": 20,
            "作品搜索量同比": "-48.7%",
            "粉丝净增": 292
            },
            "同类作者对比": {
            "播放量超越比例": "97.06%",
            "互动率": {
            "自身": "38.6%",
            "同类作者": "8.5%"
            },
            "投稿量": {
            "自身": 4,
            "同类作者": 1
            },
            "完播率": {
            "自身": "34.5%",
            "同类作者": "21.1%"
            },
            "粉丝净增": {
            "自身": 292,
            "同类作者": 1
            }
            },
            "可用模块列表": ["总览", "账号诊断", "收入分析", "作品分析", "粉丝分析"]
        }
    '''
    video_user_name = '微微'
    video_content = '''
        关注 微微 未点赞，喜欢95，按钮 95 评论74，按钮 评论74，按钮 74 未选中，收藏收藏，按钮 收藏 分享，按钮 分享 音乐，@微微创作的原声，按钮 @微微 #热门 #串门 > 暂停视频，按钮
        从提供的网页内容中提取到该链接图片相关的详细信息如下：
        
        时间：傍晚6:22
        ​
        地点/场景：成都，精选团购相关场景
        ​
        核心内容：包含互动话语“串门串门在家等我 哈”“我来串门啦”，提及@微微，带话题标签#热门#串门
        ​
        界面相关：显示数字“677366”“95 … 74”，底部有“首页 朋友 消息 我”导航栏，支持“收藏 分享”操作，还有“开始赚钱”相关提示
        
        需要我帮你尝试访问该链接确认图片实际内容，或整理成更清晰的表格形式吗？
    '''
    # gen_prompt_html(account_json_data, video_user_name, video_content)
    url = gen_prompt_url(account_json_data, video_user_name, video_content)
    print(f'请严格根据链接中的提示词执行:\n{url}')
